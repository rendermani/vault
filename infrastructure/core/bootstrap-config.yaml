---
# Enterprise Infrastructure Bootstrap Configuration
# This file defines the bootstrap order and dependencies for the infrastructure hive

bootstrap:
  order:
    - vault        # Foundation: Secret management first
    - nomad        # Orchestration: Workload management second
    - traefik      # Gateway: Load balancer and routing last

  environments:
    - develop
    - staging
    - production

  dependencies:
    vault:
      services: []
      prerequisites:
        - tls_certificates
        - storage_backend
        - initial_secrets
    
    nomad:
      services: [vault]
      prerequisites:
        - vault_integration
        - consul_connect
        - csi_plugins
    
    traefik:
      services: [vault, nomad]
      prerequisites:
        - vault_secret_integration
        - nomad_service_discovery
        - certificate_management

  integration_points:
    vault_nomad:
      - secret_injection
      - workload_identity
      - dynamic_secrets
    
    vault_traefik:
      - dashboard_authentication
      - certificate_storage
      - api_credentials
    
    nomad_traefik:
      - service_discovery
      - health_checks
      - load_balancing

  security_layers:
    - mutual_tls
    - rbac_policies
    - audit_logging
    - secret_rotation
    - network_segmentation

monitoring:
  health_checks:
    - vault_seal_status
    - nomad_leader_election
    - traefik_service_health
  
  metrics_collection:
    - prometheus_integration
    - grafana_dashboards
    - alert_manager_rules

disaster_recovery:
  backup_strategy:
    - vault_snapshots
    - nomad_state_backup
    - traefik_config_backup
  
  recovery_procedures:
    - automated_failover
    - manual_intervention_steps
    - rollback_procedures